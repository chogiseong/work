1. 품확 대응을 위한 각 버전 (m rel) 빌드 해놓을 것. <진행중

gn7 SX2

jw1 rs4


2. get vin 하는 시점 확인. 흐름 파악

//TeleAppCommon

차량에서 획득한 VIN 정보를 획득하는 API

ccos::HResult getVin(std::string &strVinData);

ccos::HResult getVehicleIdentificationNumber(std::string &_vin); // => getVin

HResult GDbusHighCanClient::getVin(std::string &strVinData) {
#if !defined (TARGET_CCU)
    strVinData = HDiagnosis::getInstance()->getVehicleIdentificationNumber();
#endif
    return HResult::OK;
}

//ccos 에서 get
//ccos는 ccnf로 정의되어있는데 ccnf 문서 HDiagnosis에는 관련 정보가 없습니다.


getVehicleIdentificationNumber 를

void ECallServiceBase::handleIgnChnageEvent(bool fIgnStatus)
여기서 사용

//handleIgnChnageEvent는 TeleApp RCS, SAS, VRM 각 서비스에서 전반적으로 사용
//getVehicleIdentificationNumber는 ECallServiceBase에서 사용

handleIgnChnageEvent는

SASManager::getInstance().addEvent(EVENT_POWER_CHANGED_IGN,
                                           [value](HANDLE_E_FUNC_DATA pData){
            auto o = reinterpret_cast<ServiceBase*>(pData);
            o->handleIgnChnageEvent(value);
        });

        VRMManager::getInstance().addEvent(EVENT_POWER_CHANGED_IGN,
                                           [value](HANDLE_E_FUNC_DATA pData){
            auto o = reinterpret_cast<ServiceBase*>(pData);
            o->handleIgnChnageEvent(value);
        });
        RCSManager::getInstance().addEvent(EVENT_POWER_CHANGED_IGN,
                                           [value](HANDLE_E_FUNC_DATA pData){
            auto o = reinterpret_cast<ServiceBase*>(pData);
            o->handleIgnChnageEvent(value);
        });

createproxy 까지 올라감.

getVehicleIdentificationNumber를 사용하는 getVIN은
RSAServiceBase에 사용되는데
string mVin = "KMATMSTEST0000006";
result = GDbusHighCanClient::getInstance().getVin(mVin); // vin
if(mVin.empty()||(result != HResult::OK))
    {
        mVin = "KMATMSTEST0000006";
    }
기본값이 하드코딩되어있음.
RSAServiceBase::handleEvent 에서부터 호출

TeleManager

TMGR databuffer 쪽에선 데이터베이스에 저장된 VIN을 불러와 사용합니다.

secureFile에선
bool DataBuffer::getProvisioningData(const std::string& category, const std::string& key, std::string& value)
category(데베종류) key(데베컬럼) value(값) 을 통해서 vin 값을 가져온다.
key가 key_CCU_VEhicleVIN, key_VehicleVIN 일때 getCCU_VIN 한다.

안성국대리님 securedata 설명

setSecureInfo()
 암호화가 필요한 초기화 정보를 설정해 주면됩니다.
 위에만 추가 하면 알아서 암복호화가 진행되기 때문에 참고하시면 됩니다.

getSecureData
    • - DataBuffer::getSecureData(const std::string &category,
                                const std::string &key,
                                std::string &value,
                                int index,
                                std::vector<std::string> &valueList,
                                bool isNeedBackupData,
                               std::string callfunction) {

    • category 와 key 값을 주면 해당 데이터를 가져오게 됩니다.
    • valueList 는 모든값 즉 테이블명, 키명, 데이터를 가져오기위한 변수 입니다.
    • value: 는 실제 가져오는 데이터 값입니다.
    • index: 는 몇번째 데이터를 가져올건지 정합니다.
    • isNeedBackupData: 을 주면 백업데이터를 읽어오게 됩니다.
    • callfunction: 안줘도 되지만 로그로 디버깅할때 어디서 호출되었는지 알수 있습니다.
    • 참고로 3개의 값이 읽어졌을때만 값을 가져올수 있습니다.
    •  3개의 값은 Table, Column, Data 입니다.

saveSecureData
    • saveSecureData(const std::string &category, const std::string &key, const std::string &value)
    • category: 테이블명
    • key: 키값 컬럼명
    • value: 저장할 데이터 값


getvin 시점.

vin이 바뀌는 순간.

3. ccnf 3.0 대응 코드 머지요청 0

4. 중간보고서 수정 0
